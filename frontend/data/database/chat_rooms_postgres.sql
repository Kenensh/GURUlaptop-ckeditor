-- PostgreSQL version of chat_rooms.sql

-- 如果表格已存在則刪除
DROP TABLE IF EXISTS public.chat_rooms CASCADE;

CREATE TABLE public.chat_rooms (
  id SERIAL PRIMARY KEY,
  name VARCHAR(100) NOT NULL,
  creator_id INTEGER NOT NULL,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  valid SMALLINT DEFAULT 1
);

-- Insert data
INSERT INTO public.chat_rooms (id, name, creator_id, created_at, valid) VALUES
(1, 'APEX - INTOVOID娛樂賽揪團', 440, '2024-11-18 15:05:05', 1),
(2, '123123123', 440, '2024-11-18 15:08:08', 1),
(3, 'test123', 440, '2024-11-18 15:59:08', 1),
(4, 'The Updraft W3', 440, '2024-11-18 22:07:35', 1),
(5, 'APEX - INTOVOID娛樂賽揪團', 440, '2024-11-19 10:35:53', 1),
(6, '《Just Dance 舞力全開 20', 440, '2024-11-19 11:52:35', 1),
(7, '123', 440, '2024-11-19 14:30:53', 1),
(8, '123', 440, '2024-11-19 15:55:07', 1),
(9, '123123', 440, '2024-11-19 22:06:25', 1),
(10, 'CSGO娛樂賽', 440, '2024-11-19 22:46:09', 1),
(11, '123', 440, '2024-11-19 23:05:01', 1),
(12, 'test', 0, '2024-11-20 12:56:43', 1),
(13, '1234', 440, '2024-11-20 12:59:36', 1),
(14, 'test', 440, '2024-11-20 13:03:09', 1),
(15, 'testsssss', 440, '2024-11-20 13:05:21', 1),
(16, '11', 440, '2024-11-20 13:13:07', 1),
(17, 'test', 440, '2024-11-21 10:39:53', 1),
(18, '111', 440, '2024-11-21 10:56:49', 1),
(19, '123', 443, '2024-11-21 13:17:28', 1),
(20, '11', 440, '2024-11-21 17:02:15', 1),
(21, '聊天室', 440, '2024-11-23 15:39:07', 1),
(22, '123', 440, '2024-11-24 18:08:31', 1),
(23, '123', 449, '2024-11-24 18:09:32', 1),
(24, '交流區', 450, '2024-11-24 18:20:05', 1),
(25, '123', 451, '2024-11-24 18:42:54', 1),
(26, '123', 452, '2024-11-24 18:49:48', 1),
(27, '測試', 452, '2024-11-24 22:51:59', 1),
(28, 'test', 453, '2024-11-24 22:59:13', 1),
(29, '爬山', 454, '2024-11-24 23:01:37', 1),
(30, '123', 455, '2024-11-24 23:06:14', 1),
(31, '123', 457, '2024-11-24 23:11:59', 1),
(32, '123', 456, '2024-11-24 23:12:19', 1);

-- Reset sequence to continue from the last id
-- 重置序列到下一個可用ID
DO $$
BEGIN
    PERFORM setval('chat_rooms_id_seq', COALESCE((SELECT MAX(id) FROM chat_rooms), 0) + 1, false);
END $$;
